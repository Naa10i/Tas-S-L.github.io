<?php
require_once 'config.php';
require_once 'session.php';

$conn = getConnection();

// Ambil produk unggulan (6 produk terbaru)
$query = "SELECT * FROM products ORDER BY created_at DESC LIMIT 6";
$result = $conn->query($query);
$featured_products = [];
if ($result) {
    while ($row = $result->fetch_assoc()) {
        $featured_products[] = $row;
    }
}

// Hitung jumlah item di cart
$session_id = getUserSessionId();
$cart_query = "SELECT SUM(quantity) as total FROM cart WHERE session_id = ?";
$stmt = $conn->prepare($cart_query);
$stmt->bind_param("s", $session_id);
$stmt->execute();
$cart_result = $stmt->get_result();
$cart_count = $cart_result->fetch_assoc()['total'] ?? 0;

$conn->close();
?>
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S&L Bag Production - Toko Tas Berkualitas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <h1>S&L Bags</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.php" class="active">Home</a></li>
                <li><a href="products.php">Produk</a></li>
                <li><a href="contact.php">Kontak</a></li>
                <li><a href="cart.php" class="cart-link">
                    ðŸ›’ Keranjang <span class="cart-badge"><?php echo $cart_count; ?></span>
                </a></li>
                <li><a href="login.php" class="admin-link">Admin</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Selamat Datang di S&L Bag Production</h1>
            <p class="hero-subtitle">Produksi Tas Berkualitas Tinggi dengan Desain Modern</p>
            <a href="products.php" class="btn btn-primary">Lihat Koleksi Kami</a>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-section">
        <div class="container">
            <h2 class="section-title">Tentang S&L Bags</h2>
            <div class="about-content">
                <p>S&L Bag Production adalah produsen tas berkualitas tinggi yang telah berpengalaman dalam industri fashion dan leather goods. Kami memproduksi berbagai jenis tas mulai dari tas ransel, tas laptop, tas selempang, hingga tas travel dengan desain modern dan material premium.</p>
                <div class="features">
                    <div class="feature-item">
                        <div class="feature-icon">âœ¨</div>
                        <h3>Kualitas Premium</h3>
                        <p>Material pilihan dan jahitan rapi</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ðŸŽ¨</div>
                        <h3>Desain Modern</h3>
                        <p>Mengikuti tren fashion terkini</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ðŸ’ª</div>
                        <h3>Tahan Lama</h3>
                        <p>Produk awet dan berkualitas</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="products-section">
        <div class="container">
            <h2 class="section-title">Produk Unggulan</h2>
            <div class="products-grid">
                <?php foreach ($featured_products as $product): ?>
                <div class="product-card">
                    <div class="product-image">
                        <img src="uploads/<?php echo htmlspecialchars($product['gambar']); ?>" 
                             alt="<?php echo htmlspecialchars($product['nama_produk']); ?>"
                             onerror="this.src='https://via.placeholder.com/300x300?text=<?php echo urlencode($product['nama_produk']); ?>'">
                    </div>
                    <div class="product-info">
                        <h3><?php echo htmlspecialchars($product['nama_produk']); ?></h3>
                        <p class="product-price">Rp <?php echo number_format($product['harga'], 0, ',', '.'); ?></p>
                        <p class="product-stock">Stok: <?php echo $product['stok']; ?></p>
                        <div class="product-actions">
                            <a href="product_detail.php?id=<?php echo $product['id']; ?>" class="btn btn-secondary">Detail</a>
                            <a href="add_to_cart.php?id=<?php echo $product['id']; ?>" class="btn btn-primary">Tambah ke Keranjang</a>
                        </div>
                    </div>
                </div>
                <?php endforeach; ?>
            </div>
            <div class="text-center" style="margin-top: 30px;">
                <a href="products.php" class="btn btn-primary">Lihat Semua Produk</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>S&L Bag Production</h3>
                    <p>Produsen tas berkualitas tinggi dengan desain modern dan material premium.</p>
                </div>
                <div class="footer-section">
                    <h3>Menu</h3>
                    <ul>
                        <li><a href="index.php">Home</a></li>
                        <li><a href="products.php">Produk</a></li>
                        <li><a href="contact.php">Kontak</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Kontak</h3>
                    <p>Email: info@slbags.com</p>
                    <p>Telp: 0857-2778-3875</p>
                    <p>WhatsApp: 0857-2778-3875</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 S&L Bag Production. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>